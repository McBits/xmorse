{"version":3,"sources":["app.js"],"names":["__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","System","register","exports_1","context_1","AudioCtx","MasterGain","VoiceGain","ToneGain","id","setters","execute","AudioContext","createGain","gain","connect","destination","exports_2","context_2","Char","lookup","enabledCharTypes","chars","Object","values","filter","char","type","Math","floor","random","toUpperCase","undefined","charType","name","pattern","voiceFileName",""," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9",".","?","!",",",":",";","'","-","/","(",")","@","=","+","\"","exports_3","context_3","audiocontext_1","Morse","ditUnits","dahUnits","sampleRate","ramp","ToneGenerator","addToneToBuffer","frequency","units","samplesPerUnit","initialSample","data","omega","PI","rampSamples","min","ceil","soundSamples","rampPos","sin","createCharacterBuffer","unitTime","charSpacing","total","i","countUnitsInPattern","totalSamples","buffer","createBuffer","getChannelData","pos","generateBuffers","allCharacters","forEach","toneAudioBuffer","charSpaceTime","GetCharacter","audiocontext_1_1","Morse_1","prototype","SetFrequency","SetCharSpacing","SetWpm","exports_4","context_4","selector","element","document","querySelector","Array","slice","querySelectorAll","getElementById","exports_5","context_5","tonegenerator_1","audiocontext_2","query_1","player_1","toneGenerator","resetSettingsButton","QueryId","volumeText","Query","charWPMText","pitchText","charSpacingText","volumeInput","charWPMInput","pitchInput","charSpacingInput","voiceEnabledInput","lettersEnabledInput","numbersEnabledInput","symbolsEnabledInput","defaults","lettersEnabled","numbersEnabled","pitch","symbolsEnabled","voiceEnabled","volume","wpm","setVolume","setTargetAtTime","currentTime","toString","setWpm","setPitch","setCharSpacing","setVoiceEnabled","player","EnableVoice","checked","setLettersEnabled","EnableCharType","setNumbersEnabled","setSymbolsEnabled","addEventListener","parseFloat","localStorage","setItem","parseInt","volumeStorage","getItem","wpmStorage","pitchStorage","charSpacingStorage","voiceEnabledStorage","lettersEnabledStorage","numbersEnabledStorage","symbolsEnabledStorage","tonegenerator_1_1","Morse_2","audiocontext_2_1","query_1_1","player_1_1","exports_6","context_6","PasteBuffer","Morse_3","textBuffer","textBufferIndex","ResetPosition","SetTextBuffer","text","trim","Next","startingIndex","morseChar","RandomCharacter","exports_7","context_7","controls_1","player_2","audiocontext_3","TonePlayer","controls_1_1","player_2_1","audiocontext_3_1","_this","patternEnded","ui","OutputChar","currentChar","PatternComplete","Stop","currentBufferSource","removeEventListener","PlayPattern","EmitCharacter","DrawPattern","createBufferSource","start","exports_8","context_8","audiocontext_4","audioBuffers","VoicePlayer","voiceDone","dispatchEvent","CustomEvent","audiocontext_4_1","Preload","loadingPromise","response","arrayBuffer","_a","err_1","_b","fetch","method","status","decodeAudioData","concat","console","error","loadVoice","audioSource","PlayVoice","loadedChar","loadedBuffer","audioBuffer","exports_9","context_9","toneplayer_1","voiceplayer_1","controls_2","Player","toneplayer_1_1","voiceplayer_1_1","controls_2_1","tonePlayer","voicePlayer","PlayNextPattern","pasteBuffer","OutputString","substr","VoiceComplete","playing","Start","Pause","exports_10","context_10","query_2","fullScreenButton","playingView","controls","menu","sidebar","isFullScreen","hideControlsInterval","lastActivity","hideControlsMS","controlsVisible","cursorVisible","exitFullScreen","classList","remove","exitFullscreen","mozCancelFullScreen","clearInterval","markTime","toggleFullScreen","setInterval","hideOrReveal","fullscreenEnabled","requestFullscreen","add","fullScreenChanged","textContent","Date","now","hideControls","style","cursor","hideCursor","showControls","showCursor","query_2_1","parentElement","exports_11","context_11","player_3","pasteBuffer_1","FullScreen","audiocontext_5","query_3","startBtns","startBtn","pauseBtn","stopBtn","gearBtn","letterElement","outputBuffer","storyLinks","patternEl","pasteTextBoxInput","ControlsUI","loadBook","href","player_3_1","pasteBuffer_1_1","FullScreen_1","audiocontext_5_1","query_3_1","QueryAll","StartPlaying","state","resume","disabled","display","location","hash","PausePlaying","StopPlaying","innerHTML","pasteTextBoxChanged","ClearOutput","substring","scrollTop","scrollHeight","make","className","el","createElement","appendChild","Initialize","evt","anchor","preventDefault","target","exports_12","context_12","query_4","routes","processHash","viewSelector","menuItemSelector","route","view","contains","button","indexOf","history","replaceState","title","window","pathname","query_4_1","#playing","#settings","#stories","#text","exports_13","context_13","Routing","Settings","controls_3","FullScreen_2","Routing_1","Settings_1","controls_3_1"],"mappings":"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","file":"app.js","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nSystem.register(\"audiocontext\", [], function (exports_1, context_1) {\n    \"use strict\";\n    var AudioCtx, MasterGain, VoiceGain, ToneGain;\n    var __moduleName = context_1 && context_1.id;\n    return {\n        setters: [],\n        execute: function () {\n            exports_1(\"AudioCtx\", AudioCtx = new AudioContext());\n            exports_1(\"MasterGain\", MasterGain = AudioCtx.createGain());\n            MasterGain.gain.value = 0.5;\n            MasterGain.connect(AudioCtx.destination);\n            exports_1(\"VoiceGain\", VoiceGain = AudioCtx.createGain());\n            VoiceGain.gain.value = 0.80;\n            VoiceGain.connect(MasterGain);\n            exports_1(\"ToneGain\", ToneGain = AudioCtx.createGain());\n            ToneGain.gain.value = 1;\n            ToneGain.connect(MasterGain);\n        }\n    };\n});\nSystem.register(\"morsetable\", [], function (exports_2, context_2) {\n    \"use strict\";\n    var Char, lookup, allCharacters, enabledCharTypes, enabledCharacters;\n    var __moduleName = context_2 && context_2.id;\n    function RandomCharacter() {\n        var chars = Object.values(lookup).filter(function (char) { return char.type & enabledCharTypes; });\n        if (chars.length > 0)\n            return chars[Math.floor(Math.random() * chars.length)];\n        return lookup[\"\"];\n    }\n    exports_2(\"RandomCharacter\", RandomCharacter);\n    function GetCharacter(char) {\n        char = char.toUpperCase();\n        return (lookup[char])\n            ? lookup[char]\n            : undefined;\n    }\n    exports_2(\"GetCharacter\", GetCharacter);\n    function EnableCharType(charType, value) {\n        enabledCharTypes ^= (-value ^ enabledCharTypes) & charType;\n    }\n    exports_2(\"EnableCharType\", EnableCharType);\n    return {\n        setters: [],\n        execute: function () {\n            Char = (function () {\n                function Char(charType, name, pattern, voiceFileName) {\n                    this.type = charType;\n                    this.name = name;\n                    this.pattern = pattern;\n                    if (voiceFileName)\n                        this.voiceFileName = voiceFileName;\n                }\n                return Char;\n            }());\n            exports_2(\"Char\", Char);\n            lookup = {\n                \"\": new Char(1, \"\", \"\"),\n                \" \": new Char(1, \" \", \" \"),\n                \"A\": new Char(2, \"A\", \".-\", \"A.mp3\"),\n                \"B\": new Char(2, \"B\", \"-...\", \"B.mp3\"),\n                \"C\": new Char(2, \"C\", \"-.-.\", \"C.mp3\"),\n                \"D\": new Char(2, \"D\", \"-..\", \"D.mp3\"),\n                \"E\": new Char(2, \"E\", \".\", \"E.mp3\"),\n                \"F\": new Char(2, \"F\", \"..-.\", \"F.mp3\"),\n                \"G\": new Char(2, \"G\", \"--.\", \"G.mp3\"),\n                \"H\": new Char(2, \"H\", \"....\", \"H.mp3\"),\n                \"I\": new Char(2, \"I\", \"..\", \"I.mp3\"),\n                \"J\": new Char(2, \"J\", \".---\", \"J.mp3\"),\n                \"K\": new Char(2, \"K\", \"-.-\", \"K.mp3\"),\n                \"L\": new Char(2, \"L\", \".-..\", \"L.mp3\"),\n                \"M\": new Char(2, \"M\", \"--\", \"M.mp3\"),\n                \"N\": new Char(2, \"N\", \"-.\", \"N.mp3\"),\n                \"O\": new Char(2, \"O\", \"---\", \"O.mp3\"),\n                \"P\": new Char(2, \"P\", \".--.\", \"P.mp3\"),\n                \"Q\": new Char(2, \"Q\", \"--.-\", \"Q.mp3\"),\n                \"R\": new Char(2, \"R\", \".-.\", \"R.mp3\"),\n                \"S\": new Char(2, \"S\", \"...\", \"S.mp3\"),\n                \"T\": new Char(2, \"T\", \"-\", \"T.mp3\"),\n                \"U\": new Char(2, \"U\", \"..-\", \"U.mp3\"),\n                \"V\": new Char(2, \"V\", \"...-\", \"V.mp3\"),\n                \"W\": new Char(2, \"W\", \".--\", \"W.mp3\"),\n                \"X\": new Char(2, \"X\", \"-..-\", \"X.mp3\"),\n                \"Y\": new Char(2, \"Y\", \"-.--\", \"Y.mp3\"),\n                \"Z\": new Char(2, \"Z\", \"--..\", \"Z.mp3\"),\n                \"0\": new Char(4, \"0\", \"-----\", \"0.mp3\"),\n                \"1\": new Char(4, \"1\", \".----\", \"1.mp3\"),\n                \"2\": new Char(4, \"2\", \"..---\", \"2.mp3\"),\n                \"3\": new Char(4, \"3\", \"...--\", \"3.mp3\"),\n                \"4\": new Char(4, \"4\", \"....-\", \"4.mp3\"),\n                \"5\": new Char(4, \"5\", \".....\", \"5.mp3\"),\n                \"6\": new Char(4, \"6\", \"-....\", \"6.mp3\"),\n                \"7\": new Char(4, \"7\", \"--...\", \"7.mp3\"),\n                \"8\": new Char(4, \"8\", \"---..\", \"8.mp3\"),\n                \"9\": new Char(4, \"9\", \"----.\", \"9.mp3\"),\n                \".\": new Char(8, \".\", \".-.-.-\", \"PERIOD.mp3\"),\n                \"?\": new Char(8, \"?\", \"..--..\", \"QUESTION.mp3\"),\n                \"!\": new Char(8, \"!\", \"-.-.--\", \"EXCLAMATION.mp3\"),\n                \",\": new Char(8, \",\", \"--..--\", \"COMMA.mp3\"),\n                \":\": new Char(8, \":\", \"---...\", \"COLON.mp3\"),\n                \";\": new Char(8, \";\", \"-.-.-.\", \"SEMICOLON.mp3\"),\n                \"'\": new Char(8, \"'\", \".----.\", \"APOSTROPHE.mp3\"),\n                \"-\": new Char(8, \"-\", \"-....-\", \"DASH.mp3\"),\n                \"/\": new Char(8, \"/\", \"-..-.\", \"SLASH.mp3\"),\n                \"(\": new Char(8, \"(\", \"-.--.\", \"OPEN_BRACKET.mp3\"),\n                \")\": new Char(8, \")\", \"-.--.-\", \"CLOSE_BRACKET.mp3\"),\n                \"@\": new Char(8, \"@\", \".--.-.\", \"AT.mp3\"),\n                \"=\": new Char(8, \"=\", \"-...-\", \"EQUALS.mp3\"),\n                \"+\": new Char(8, \"+\", \".-.-.\", \"PLUS.mp3\"),\n                \"\\\"\": new Char(8, \"\\\"\", \".-..-.\", \"QUOTE.mp3\"),\n            };\n            exports_2(\"allCharacters\", allCharacters = Object.values(lookup).filter(function (char) { return char.type & (2 | 4 | 8); }));\n            enabledCharTypes = 0;\n            enabledCharacters = [];\n        }\n    };\n});\nSystem.register(\"tonegenerator\", [\"audiocontext\", \"morsetable\"], function (exports_3, context_3) {\n    \"use strict\";\n    var audiocontext_1, Morse, ditUnits, dahUnits, sampleRate, ramp, ToneGenerator;\n    var __moduleName = context_3 && context_3.id;\n    function countUnitsInPattern(pattern) {\n        var total = 0;\n        for (var i = 0; i < pattern.length; ++i) {\n            total += (pattern[i] === \".\" ? ditUnits : dahUnits) + ditUnits;\n        }\n        return total;\n    }\n    function addToneToBuffer(frequency, units, samplesPerUnit, initialSample, data) {\n        var omega = 2 * Math.PI * frequency / sampleRate;\n        var rampSamples = Math.min(Math.ceil(ramp * sampleRate), samplesPerUnit);\n        var soundSamples = Math.ceil(samplesPerUnit * units);\n        for (var t = initialSample, rampPos = 0; t < initialSample + rampSamples; ++t, ++rampPos) {\n            data[t] = Math.sin(omega * t) * (rampPos / rampSamples);\n        }\n        for (var t = initialSample + rampSamples; t < initialSample + soundSamples - rampSamples; ++t) {\n            data[t] = Math.sin(omega * t);\n        }\n        for (var t = initialSample + soundSamples - rampSamples, rampPos = rampSamples; t < initialSample + soundSamples; ++t, --rampPos) {\n            data[t] = Math.sin(omega * t) * (rampPos / rampSamples);\n        }\n    }\n    function createCharacterBuffer(frequency, unitTime, charSpacing, char) {\n        var pattern = char.pattern;\n        var units = countUnitsInPattern(pattern);\n        var samplesPerUnit = Math.ceil(unitTime * sampleRate);\n        var rampSamples = Math.min(Math.ceil(ramp * sampleRate), samplesPerUnit);\n        var soundSamples = Math.ceil(samplesPerUnit * units);\n        var totalSamples = Math.ceil(samplesPerUnit * units + (samplesPerUnit * charSpacing));\n        var buffer = audiocontext_1.AudioCtx.createBuffer(1, totalSamples, sampleRate);\n        var data = buffer.getChannelData(0);\n        var pos = 0;\n        for (var i = 0; i < pattern.length; ++i) {\n            switch (pattern[i]) {\n                case \".\":\n                    addToneToBuffer(frequency, ditUnits, samplesPerUnit, pos, data);\n                    pos += samplesPerUnit * (ditUnits + ditUnits);\n                    break;\n                case \"-\":\n                    addToneToBuffer(frequency, dahUnits, samplesPerUnit, pos, data);\n                    pos += samplesPerUnit * (dahUnits + ditUnits);\n                    break;\n            }\n        }\n        return buffer;\n    }\n    function generateBuffers(frequency, unitTime, charSpacing) {\n        Morse.allCharacters.forEach(function (char) { return char.toneAudioBuffer = createCharacterBuffer(frequency, unitTime, charSpacing, char); });\n        var charSpaceTime = unitTime * sampleRate * charSpacing;\n        Morse.GetCharacter(\"\").toneAudioBuffer = audiocontext_1.AudioCtx.createBuffer(1, charSpaceTime, sampleRate);\n        Morse.GetCharacter(\" \").toneAudioBuffer = audiocontext_1.AudioCtx.createBuffer(1, charSpaceTime * 3, sampleRate);\n    }\n    return {\n        setters: [\n            function (audiocontext_1_1) {\n                audiocontext_1 = audiocontext_1_1;\n            },\n            function (Morse_1) {\n                Morse = Morse_1;\n            }\n        ],\n        execute: function () {\n            ditUnits = 1;\n            dahUnits = 3;\n            sampleRate = 48000;\n            ramp = 0.01;\n            ToneGenerator = (function () {\n                function ToneGenerator() {\n                    this.frequency = 650;\n                    this.charSpacing = 2;\n                }\n                ToneGenerator.prototype.SetFrequency = function (value) {\n                    this.frequency = value;\n                    generateBuffers(this.frequency, this.unitTime, this.charSpacing);\n                };\n                ToneGenerator.prototype.SetCharSpacing = function (value) {\n                    this.charSpacing = value;\n                    generateBuffers(this.frequency, this.unitTime, this.charSpacing);\n                };\n                ToneGenerator.prototype.SetWpm = function (value) {\n                    this.unitTime = 1.2 / value;\n                    generateBuffers(this.frequency, this.unitTime, this.charSpacing);\n                };\n                return ToneGenerator;\n            }());\n            exports_3(\"ToneGenerator\", ToneGenerator);\n        }\n    };\n});\nSystem.register(\"query\", [], function (exports_4, context_4) {\n    \"use strict\";\n    var __moduleName = context_4 && context_4.id;\n    function Query(selector, element) {\n        return (element || document).querySelector(selector);\n    }\n    exports_4(\"Query\", Query);\n    function QueryAll(selector, element) {\n        return Array.prototype.slice.call((element || document).querySelectorAll(selector));\n    }\n    exports_4(\"QueryAll\", QueryAll);\n    function QueryId(id) {\n        return document.getElementById(id);\n    }\n    exports_4(\"QueryId\", QueryId);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\nSystem.register(\"settings\", [\"tonegenerator\", \"morsetable\", \"audiocontext\", \"query\", \"player\"], function (exports_5, context_5) {\n    \"use strict\";\n    var tonegenerator_1, Morse, audiocontext_2, query_1, player_1;\n    var __moduleName = context_5 && context_5.id;\n    function Initialize() {\n        var toneGenerator = new tonegenerator_1.ToneGenerator();\n        var resetSettingsButton = query_1.QueryId(\"resetSettings\");\n        var volumeText = query_1.Query(\".volumeText\");\n        var charWPMText = query_1.Query(\".charWPMText\");\n        var pitchText = query_1.Query(\".pitchText\");\n        var charSpacingText = query_1.Query(\".charSpacingText\");\n        var volumeInput = query_1.QueryId(\"volume\");\n        var charWPMInput = query_1.QueryId(\"charWPM\");\n        var pitchInput = query_1.QueryId(\"pitch\");\n        var charSpacingInput = query_1.QueryId(\"charSpacing\");\n        var voiceEnabledInput = query_1.QueryId(\"voiceEnabled\");\n        var lettersEnabledInput = query_1.QueryId(\"lettersEnabled\");\n        var numbersEnabledInput = query_1.QueryId(\"numbersEnabled\");\n        var symbolsEnabledInput = query_1.QueryId(\"symbolsEnabled\");\n        var defaults = {\n            charSpacing: 2,\n            lettersEnabled: true,\n            numbersEnabled: false,\n            pitch: 650,\n            symbolsEnabled: false,\n            voiceEnabled: true,\n            volume: 0.40,\n            wpm: 10\n        };\n        function setVolume(value) {\n            audiocontext_2.MasterGain.gain.setTargetAtTime(value, audiocontext_2.AudioCtx.currentTime, 0.01);\n            volumeText.value = Math.floor(value * 100).toString();\n            volumeInput.value = value.toString();\n        }\n        function setWpm(value) {\n            toneGenerator.SetWpm(value);\n            charWPMText.value = value.toString();\n            charWPMInput.value = value.toString();\n        }\n        function setPitch(value) {\n            toneGenerator.SetFrequency(value);\n            pitchText.value = value.toString();\n            pitchInput.value = value.toString();\n        }\n        function setCharSpacing(value) {\n            toneGenerator.SetCharSpacing(value);\n            charSpacingText.value = value.toString();\n            charSpacingInput.value = value.toString();\n        }\n        function setVoiceEnabled(value) {\n            player_1.player.EnableVoice(value);\n            voiceEnabledInput.checked = value;\n        }\n        function setLettersEnabled(value) {\n            Morse.EnableCharType(2, value);\n            lettersEnabledInput.checked = value;\n        }\n        function setNumbersEnabled(value) {\n            Morse.EnableCharType(4, value);\n            numbersEnabledInput.checked = value;\n        }\n        function setSymbolsEnabled(value) {\n            Morse.EnableCharType(8, value);\n            symbolsEnabledInput.checked = value;\n        }\n        volumeInput.addEventListener(\"input\", function () {\n            var value = parseFloat(volumeInput.value);\n            localStorage.setItem(\"volume\", value.toString());\n            setVolume(value);\n        });\n        charWPMInput.addEventListener(\"input\", function () {\n            var value = parseInt(charWPMInput.value);\n            localStorage.setItem(\"wpm\", value.toString());\n            setWpm(value);\n        });\n        charSpacingInput.addEventListener(\"input\", function () {\n            var value = parseInt(charSpacingInput.value);\n            localStorage.setItem(\"charSpacing\", value.toString());\n            setCharSpacing(value);\n        });\n        pitchInput.addEventListener(\"input\", function () {\n            var value = parseInt(pitchInput.value);\n            localStorage.setItem(\"pitch\", value.toString());\n            setPitch(value);\n        });\n        voiceEnabledInput.addEventListener(\"change\", function () {\n            var value = voiceEnabledInput.checked;\n            localStorage.setItem(\"voiceEnabled\", value.toString());\n            player_1.player.EnableVoice(value);\n        });\n        lettersEnabledInput.addEventListener(\"change\", function () {\n            localStorage.setItem(\"lettersEnabled\", lettersEnabledInput.checked.toString());\n            setLettersEnabled(lettersEnabledInput.checked);\n        });\n        numbersEnabledInput.addEventListener(\"change\", function () {\n            localStorage.setItem(\"numbersEnabled\", numbersEnabledInput.checked.toString());\n            setNumbersEnabled(numbersEnabledInput.checked);\n        });\n        symbolsEnabledInput.addEventListener(\"change\", function () {\n            localStorage.setItem(\"symbolsEnabled\", symbolsEnabledInput.checked.toString());\n            setSymbolsEnabled(symbolsEnabledInput.checked);\n        });\n        resetSettingsButton.addEventListener(\"click\", function () {\n            localStorage.setItem(\"charSpacing\", defaults.charSpacing.toString());\n            setCharSpacing(defaults.charSpacing);\n            localStorage.setItem(\"lettersEnabled\", defaults.lettersEnabled.toString());\n            setLettersEnabled(defaults.lettersEnabled);\n            localStorage.setItem(\"numbersEnabled\", defaults.numbersEnabled.toString());\n            setNumbersEnabled(defaults.numbersEnabled);\n            localStorage.setItem(\"pitch\", defaults.pitch.toString());\n            setPitch(defaults.pitch);\n            localStorage.setItem(\"symbolsEnabled\", defaults.symbolsEnabled.toString());\n            setSymbolsEnabled(defaults.symbolsEnabled);\n            localStorage.setItem(\"voiceEnabled\", defaults.voiceEnabled.toString());\n            setVoiceEnabled(defaults.voiceEnabled);\n            localStorage.setItem(\"volume\", defaults.volume.toString());\n            setVolume(defaults.volume);\n            localStorage.setItem(\"wpm\", defaults.wpm.toString());\n            setWpm(defaults.wpm);\n        });\n        var volumeStorage = localStorage.getItem(\"volume\");\n        var volume = volumeStorage == null\n            ? defaults.volume\n            : parseFloat(volumeStorage);\n        setVolume(volume);\n        var wpmStorage = localStorage.getItem(\"wpm\");\n        var wpm = wpmStorage == null\n            ? defaults.wpm\n            : parseInt(wpmStorage);\n        setWpm(wpm);\n        var pitchStorage = localStorage.getItem(\"pitch\");\n        var pitch = pitchStorage == null\n            ? defaults.pitch\n            : parseInt(pitchStorage);\n        setPitch(pitch);\n        var charSpacingStorage = localStorage.getItem(\"charSpacing\");\n        var charSpacing = charSpacingStorage == null\n            ? defaults.charSpacing\n            : parseInt(charSpacingStorage);\n        setCharSpacing(charSpacing);\n        var voiceEnabledStorage = localStorage.getItem(\"voiceEnabled\");\n        var voiceEnabled = voiceEnabledStorage == null\n            ? defaults.voiceEnabled\n            : voiceEnabledStorage === \"true\";\n        setVoiceEnabled(voiceEnabled);\n        var lettersEnabledStorage = localStorage.getItem(\"lettersEnabled\");\n        var lettersEnabled = lettersEnabledStorage == null\n            ? defaults.lettersEnabled\n            : lettersEnabledStorage === \"true\";\n        setLettersEnabled(lettersEnabled);\n        var numbersEnabledStorage = localStorage.getItem(\"numbersEnabled\");\n        var numbersEnabled = numbersEnabledStorage == null\n            ? defaults.numbersEnabled\n            : numbersEnabledStorage === \"true\";\n        setNumbersEnabled(numbersEnabled);\n        var symbolsEnabledStorage = localStorage.getItem(\"symbolsEnabled\");\n        var symbolsEnabled = symbolsEnabledStorage == null\n            ? defaults.symbolsEnabled\n            : symbolsEnabledStorage === \"true\";\n        setSymbolsEnabled(symbolsEnabled);\n    }\n    exports_5(\"Initialize\", Initialize);\n    return {\n        setters: [\n            function (tonegenerator_1_1) {\n                tonegenerator_1 = tonegenerator_1_1;\n            },\n            function (Morse_2) {\n                Morse = Morse_2;\n            },\n            function (audiocontext_2_1) {\n                audiocontext_2 = audiocontext_2_1;\n            },\n            function (query_1_1) {\n                query_1 = query_1_1;\n            },\n            function (player_1_1) {\n                player_1 = player_1_1;\n            }\n        ],\n        execute: function () {\n        }\n    };\n});\nSystem.register(\"pasteBuffer\", [\"morsetable\"], function (exports_6, context_6) {\n    \"use strict\";\n    var Morse, PasteBuffer;\n    var __moduleName = context_6 && context_6.id;\n    return {\n        setters: [\n            function (Morse_3) {\n                Morse = Morse_3;\n            }\n        ],\n        execute: function () {\n            PasteBuffer = (function () {\n                function PasteBuffer() {\n                    this.textBuffer = \"\";\n                    this.textBufferIndex = -1;\n                }\n                PasteBuffer.prototype.ResetPosition = function () {\n                    this.textBufferIndex = this.textBuffer.length > 0 ? 0 : -1;\n                };\n                PasteBuffer.prototype.SetTextBuffer = function (text) {\n                    if (text) {\n                        text = text.toUpperCase().trim() + \"\\n\";\n                        if (text != this.textBuffer) {\n                            this.textBuffer = text;\n                            this.ResetPosition();\n                        }\n                    }\n                };\n                PasteBuffer.prototype.Next = function () {\n                    if (this.textBuffer.length > 0) {\n                        var startingIndex = this.textBufferIndex;\n                        var text = \"\";\n                        do {\n                            text += this.textBuffer[this.textBufferIndex];\n                            var morseChar = Morse.GetCharacter(this.textBuffer[this.textBufferIndex]);\n                            ++this.textBufferIndex;\n                            if (this.textBufferIndex === this.textBuffer.length)\n                                this.textBufferIndex = 0;\n                            if (morseChar)\n                                return [text, morseChar];\n                        } while (this.textBufferIndex !== startingIndex);\n                        return [\"\", Morse.GetCharacter(\"\")];\n                    }\n                    var char = Morse.RandomCharacter();\n                    return [char.name, char];\n                };\n                return PasteBuffer;\n            }());\n            exports_6(\"PasteBuffer\", PasteBuffer);\n        }\n    };\n});\nSystem.register(\"toneplayer\", [\"controls\", \"player\", \"audiocontext\"], function (exports_7, context_7) {\n    \"use strict\";\n    var controls_1, player_2, audiocontext_3, TonePlayer;\n    var __moduleName = context_7 && context_7.id;\n    return {\n        setters: [\n            function (controls_1_1) {\n                controls_1 = controls_1_1;\n            },\n            function (player_2_1) {\n                player_2 = player_2_1;\n            },\n            function (audiocontext_3_1) {\n                audiocontext_3 = audiocontext_3_1;\n            }\n        ],\n        execute: function () {\n            TonePlayer = (function () {\n                function TonePlayer() {\n                    var _this = this;\n                    this.patternEnded = function () {\n                        controls_1.ui.OutputChar(_this.currentChar);\n                        return player_2.player.PatternComplete(_this.currentChar);\n                    };\n                }\n                TonePlayer.prototype.Stop = function () {\n                    if (this.currentBufferSource) {\n                        this.currentBufferSource.removeEventListener(\"ended\", this.patternEnded);\n                        this.currentBufferSource = undefined;\n                    }\n                };\n                TonePlayer.prototype.PlayPattern = function (char) {\n                    this.currentChar = char;\n                    controls_1.ui.EmitCharacter(char.name);\n                    controls_1.ui.DrawPattern(char.pattern);\n                    this.currentBufferSource = audiocontext_3.AudioCtx.createBufferSource();\n                    this.currentBufferSource.connect(audiocontext_3.ToneGain);\n                    this.currentBufferSource.buffer = char.toneAudioBuffer;\n                    this.currentBufferSource.addEventListener(\"ended\", this.patternEnded);\n                    this.currentBufferSource.start();\n                };\n                return TonePlayer;\n            }());\n            exports_7(\"TonePlayer\", TonePlayer);\n        }\n    };\n});\nSystem.register(\"voiceplayer\", [\"audiocontext\"], function (exports_8, context_8) {\n    \"use strict\";\n    var audiocontext_4, audioBuffers, VoicePlayer;\n    var __moduleName = context_8 && context_8.id;\n    function voiceDone() {\n        document.dispatchEvent(new CustomEvent(\"voicedone\"));\n    }\n    function loadVoice(char) {\n        return __awaiter(this, void 0, void 0, function () {\n            var response, arrayBuffer, _a, err_1;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _b.trys.push([0, 6, , 7]);\n                        return [4, fetch(\"/snd/\" + char.voiceFileName, { method: \"GET\" })];\n                    case 1:\n                        response = _b.sent();\n                        if (!(response.status === 200 || response.status === 304)) return [3, 4];\n                        return [4, response.arrayBuffer()];\n                    case 2:\n                        arrayBuffer = _b.sent();\n                        _a = [char];\n                        return [4, audiocontext_4.AudioCtx.decodeAudioData(arrayBuffer)];\n                    case 3: return [2, _a.concat([_b.sent()])];\n                    case 4: throw \"Failed to fetch audio.\";\n                    case 5: return [3, 7];\n                    case 6:\n                        err_1 = _b.sent();\n                        console.error(\"Error deocding audio source: \", err_1);\n                        return [3, 7];\n                    case 7: return [2];\n                }\n            });\n        });\n    }\n    return {\n        setters: [\n            function (audiocontext_4_1) {\n                audiocontext_4 = audiocontext_4_1;\n            }\n        ],\n        execute: function () {\n            audioBuffers = {};\n            VoicePlayer = (function () {\n                function VoicePlayer() {\n                }\n                VoicePlayer.prototype.Preload = function (char) {\n                    if (!audioBuffers[char.name] && char && char.voiceFileName)\n                        this.loadingPromise = loadVoice(char);\n                };\n                VoicePlayer.prototype.Stop = function () {\n                    if (this.audioSource) {\n                        this.audioSource.removeEventListener(\"ended\", voiceDone);\n                        this.audioSource = undefined;\n                    }\n                };\n                VoicePlayer.prototype.PlayVoice = function (char) {\n                    return __awaiter(this, void 0, void 0, function () {\n                        var _a, loadedChar, loadedBuffer, audioBuffer;\n                        return __generator(this, function (_b) {\n                            switch (_b.label) {\n                                case 0:\n                                    if (!(!char || !char.voiceFileName)) return [3, 1];\n                                    voiceDone();\n                                    return [3, 4];\n                                case 1:\n                                    if (!this.loadingPromise) return [3, 3];\n                                    return [4, this.loadingPromise];\n                                case 2:\n                                    _a = _b.sent(), loadedChar = _a[0], loadedBuffer = _a[1];\n                                    audioBuffers[loadedChar.name] = loadedBuffer;\n                                    this.loadingPromise = undefined;\n                                    _b.label = 3;\n                                case 3:\n                                    audioBuffer = audioBuffers[char.name];\n                                    if (audioBuffer) {\n                                        this.audioSource = audiocontext_4.AudioCtx.createBufferSource();\n                                        this.audioSource.addEventListener(\"ended\", voiceDone);\n                                        this.audioSource.buffer = audioBuffer;\n                                        this.audioSource.connect(audiocontext_4.VoiceGain);\n                                        this.audioSource.start(0);\n                                    }\n                                    else {\n                                        voiceDone();\n                                    }\n                                    _b.label = 4;\n                                case 4: return [2];\n                            }\n                        });\n                    });\n                };\n                return VoicePlayer;\n            }());\n            exports_8(\"VoicePlayer\", VoicePlayer);\n        }\n    };\n});\nSystem.register(\"player\", [\"toneplayer\", \"voiceplayer\", \"controls\"], function (exports_9, context_9) {\n    \"use strict\";\n    var toneplayer_1, voiceplayer_1, controls_2, Player, player;\n    var __moduleName = context_9 && context_9.id;\n    return {\n        setters: [\n            function (toneplayer_1_1) {\n                toneplayer_1 = toneplayer_1_1;\n            },\n            function (voiceplayer_1_1) {\n                voiceplayer_1 = voiceplayer_1_1;\n            },\n            function (controls_2_1) {\n                controls_2 = controls_2_1;\n            }\n        ],\n        execute: function () {\n            Player = (function () {\n                function Player(tonePlayer, voicePlayer) {\n                    var _this = this;\n                    this.tonePlayer = tonePlayer;\n                    this.voicePlayer = voicePlayer;\n                    this.PlayNextPattern = function () { return __awaiter(_this, void 0, void 0, function () {\n                        var _a, text, morseChar;\n                        return __generator(this, function (_b) {\n                            _a = controls_2.pasteBuffer.Next(), text = _a[0], morseChar = _a[1];\n                            if (this.voiceEnabled)\n                                this.voicePlayer.Preload(morseChar);\n                            if (text !== morseChar.name) {\n                                controls_2.ui.DrawPattern(\" \");\n                                controls_2.ui.EmitCharacter(\"\");\n                                controls_2.ui.OutputString(text.substr(0, text.length - 1));\n                            }\n                            this.tonePlayer.PlayPattern(morseChar);\n                            return [2];\n                        });\n                    }); };\n                    this.VoiceComplete = function () { return __awaiter(_this, void 0, void 0, function () {\n                        return __generator(this, function (_a) {\n                            switch (_a.label) {\n                                case 0:\n                                    if (!this.playing) return [3, 2];\n                                    return [4, this.PlayNextPattern()];\n                                case 1:\n                                    _a.sent();\n                                    _a.label = 2;\n                                case 2: return [2];\n                            }\n                        });\n                    }); };\n                    this.PatternComplete = function (char) { return __awaiter(_this, void 0, void 0, function () {\n                        return __generator(this, function (_a) {\n                            switch (_a.label) {\n                                case 0:\n                                    if (!this.playing) return [3, 4];\n                                    if (!this.voiceEnabled) return [3, 2];\n                                    return [4, this.voicePlayer.PlayVoice(char)];\n                                case 1:\n                                    _a.sent();\n                                    return [3, 4];\n                                case 2: return [4, this.PlayNextPattern()];\n                                case 3:\n                                    _a.sent();\n                                    _a.label = 4;\n                                case 4: return [2];\n                            }\n                        });\n                    }); };\n                    document.addEventListener(\"voicedone\", this.VoiceComplete);\n                }\n                Player.prototype.Start = function () {\n                    return __awaiter(this, void 0, void 0, function () {\n                        return __generator(this, function (_a) {\n                            switch (_a.label) {\n                                case 0:\n                                    if (!!this.playing) return [3, 2];\n                                    this.playing = true;\n                                    return [4, this.PlayNextPattern()];\n                                case 1:\n                                    _a.sent();\n                                    _a.label = 2;\n                                case 2: return [2];\n                            }\n                        });\n                    });\n                };\n                Player.prototype.Pause = function () {\n                    this.playing = false;\n                };\n                Player.prototype.Stop = function () {\n                    this.playing = false;\n                    this.tonePlayer.Stop();\n                    this.voicePlayer.Stop();\n                };\n                Player.prototype.EnableVoice = function (value) {\n                    this.voiceEnabled = value;\n                };\n                return Player;\n            }());\n            exports_9(\"player\", player = new Player(new toneplayer_1.TonePlayer(), new voiceplayer_1.VoicePlayer()));\n        }\n    };\n});\nSystem.register(\"fullscreen\", [\"query\"], function (exports_10, context_10) {\n    \"use strict\";\n    var query_2, fullScreenButton, playingView, controls, menu, sidebar, isFullScreen, hideControlsInterval, lastActivity, hideControlsMS, controlsVisible, cursorVisible;\n    var __moduleName = context_10 && context_10.id;\n    function exitFullScreen() {\n        document.body.classList.remove(\"fullscreen\");\n        if (document.exitFullscreen)\n            document.exitFullscreen();\n        else if (document[\"webkitExitFullscreen\"])\n            document[\"webkitExitFullscreen\"]();\n        else if (document.mozCancelFullScreen)\n            document[\"mozCancelFullScreen\"]();\n        clearInterval(hideControlsInterval);\n        document.removeEventListener(\"mousemove\", markTime);\n    }\n    function enterFullScreen() {\n        document.addEventListener(\"mousemove\", markTime);\n        hideControlsInterval = setInterval(hideOrReveal, 200);\n        if (document.fullscreenEnabled)\n            playingView.requestFullscreen();\n        else if (document[\"webkitFullscreenEnabled\"])\n            playingView[\"webkitRequestFullscreen\"]();\n        else if (document[\"mozFullScreenEnabled\"])\n            playingView[\"mozRequestFullScreen\"]();\n        document.body.classList.add(\"fullscreen\");\n    }\n    function toggleFullScreen() {\n        if (isFullScreen)\n            exitFullScreen();\n        else\n            enterFullScreen();\n    }\n    function fullScreenChanged() {\n        isFullScreen = !isFullScreen;\n        fullScreenButton.textContent = isFullScreen ? \"Exit full screen\" : \"Full screen\";\n        lastActivity = Date.now();\n    }\n    function markTime() {\n        lastActivity = Date.now();\n    }\n    function hideOrReveal() {\n        if (isFullScreen && Date.now() - lastActivity > hideControlsMS) {\n            hideControls();\n            hideCursor();\n        }\n        else {\n            showControls();\n            showCursor();\n        }\n    }\n    function hideCursor() {\n        if (cursorVisible)\n            playingView.style.cursor = \"none\";\n        cursorVisible = false;\n    }\n    function showCursor() {\n        if (!cursorVisible)\n            playingView.style.cursor = \"default\";\n        cursorVisible = true;\n    }\n    function hideControls() {\n        if (controlsVisible) {\n            fullScreenButton.classList.add(\"disabled\");\n            controls.classList.add(\"disabled\");\n            menu.classList.add(\"disabled\");\n            sidebar.classList.add(\"disabled\");\n        }\n        controlsVisible = false;\n    }\n    function showControls() {\n        if (!controlsVisible) {\n            fullScreenButton.classList.remove(\"disabled\");\n            controls.classList.remove(\"disabled\");\n            menu.classList.remove(\"disabled\");\n            sidebar.classList.remove(\"disabled\");\n        }\n        controlsVisible = true;\n    }\n    function StopPlaying() {\n        showCursor();\n        showControls();\n        if (isFullScreen)\n            exitFullScreen();\n    }\n    exports_10(\"StopPlaying\", StopPlaying);\n    function Initialize() {\n        if (document.fullscreenEnabled)\n            document.addEventListener(\"fullscreenchange\", fullScreenChanged);\n        else if (document[\"webkitFullscreenEnabled\"])\n            document.addEventListener(\"webkitfullscreenchange\", fullScreenChanged);\n        else if (document[\"mozFullScreenEnabled\"])\n            document.addEventListener(\"mozfullscreenchange\", fullScreenChanged);\n        fullScreenButton.addEventListener(\"click\", toggleFullScreen);\n    }\n    exports_10(\"Initialize\", Initialize);\n    return {\n        setters: [\n            function (query_2_1) {\n                query_2 = query_2_1;\n            }\n        ],\n        execute: function () {\n            fullScreenButton = query_2.Query(\".btn-fullscreen\");\n            playingView = document.body.parentElement;\n            controls = query_2.Query(\".controls\");\n            menu = query_2.Query(\".menu\");\n            sidebar = query_2.Query(\".sidebar\");\n            isFullScreen = false;\n            lastActivity = Date.now();\n            hideControlsMS = 2000;\n            controlsVisible = false;\n            cursorVisible = false;\n        }\n    };\n});\nSystem.register(\"controls\", [\"player\", \"pasteBuffer\", \"fullscreen\", \"audiocontext\", \"query\"], function (exports_11, context_11) {\n    \"use strict\";\n    var player_3, pasteBuffer_1, FullScreen, audiocontext_5, query_3, homeBtn, startBtns, startBtn, pauseBtn, stopBtn, gearBtn, letterElement, outputBuffer, storyLinks, patternEl, pasteTextBoxInput, ControlsUI, ui, pasteBuffer;\n    var __moduleName = context_11 && context_11.id;\n    function loadBook(href) {\n        return __awaiter(this, void 0, void 0, function () {\n            var response;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4, fetch(href, { method: \"GET\" })];\n                    case 1:\n                        response = _a.sent();\n                        return [2, response.text()];\n                }\n            });\n        });\n    }\n    return {\n        setters: [\n            function (player_3_1) {\n                player_3 = player_3_1;\n            },\n            function (pasteBuffer_1_1) {\n                pasteBuffer_1 = pasteBuffer_1_1;\n            },\n            function (FullScreen_1) {\n                FullScreen = FullScreen_1;\n            },\n            function (audiocontext_5_1) {\n                audiocontext_5 = audiocontext_5_1;\n            },\n            function (query_3_1) {\n                query_3 = query_3_1;\n            }\n        ],\n        execute: function () {\n            homeBtn = query_3.Query(\".btn-home\");\n            startBtns = query_3.QueryAll(\".btn-start\");\n            startBtn = query_3.Query(\".btn-start\");\n            pauseBtn = query_3.Query(\".btn-pause\");\n            stopBtn = query_3.Query(\".btn-stop\");\n            gearBtn = query_3.Query(\".btn-gear\");\n            letterElement = query_3.Query(\".letter\");\n            outputBuffer = query_3.Query(\".outputBuffer\");\n            storyLinks = query_3.QueryAll(\".story a\");\n            patternEl = query_3.Query(\".view.playing .pattern\");\n            pasteTextBoxInput = query_3.QueryId(\"pasteText\");\n            ControlsUI = (function () {\n                function ControlsUI() {\n                    var _this = this;\n                    this.StartPlaying = function () {\n                        if (audiocontext_5.AudioCtx.state === \"suspended\")\n                            audiocontext_5.AudioCtx.resume();\n                        startBtn.disabled = true;\n                        pauseBtn.disabled = false;\n                        stopBtn.disabled = false;\n                        startBtn.style.display = \"none\";\n                        pauseBtn.style.display = \"initial\";\n                        location.hash = \"#playing\";\n                        pasteBuffer.SetTextBuffer(pasteTextBoxInput.value.length > 0 ? pasteTextBoxInput.value : undefined);\n                        player_3.player.Start();\n                    };\n                    this.PausePlaying = function () {\n                        startBtn.disabled = false;\n                        pauseBtn.disabled = true;\n                        stopBtn.disabled = false;\n                        pauseBtn.style.display = \"none\";\n                        startBtn.style.display = \"initial\";\n                        player_3.player.Pause();\n                    };\n                    this.StopPlaying = function () {\n                        player_3.player.Stop();\n                        FullScreen.StopPlaying();\n                        pasteBuffer.ResetPosition();\n                        outputBuffer.innerHTML = \"\";\n                        letterElement.innerHTML = \"\";\n                        patternEl.innerHTML = \"\";\n                        startBtn.disabled = false;\n                        pauseBtn.disabled = true;\n                        stopBtn.disabled = true;\n                        pauseBtn.style.display = \"none\";\n                        startBtn.style.display = \"initial\";\n                    };\n                    this.pasteTextBoxChanged = function () {\n                        var value = pasteTextBoxInput.value;\n                        localStorage.setItem(\"textBuffer\", value);\n                        _this.StopPlaying();\n                        _this.ClearOutput();\n                    };\n                }\n                ControlsUI.prototype.ClearOutput = function () {\n                    outputBuffer.innerHTML = \"\";\n                };\n                ControlsUI.prototype.EmitCharacter = function (char) {\n                    letterElement.innerHTML = char;\n                };\n                ControlsUI.prototype.OutputString = function (value) {\n                    var text = outputBuffer.innerHTML;\n                    if (text.length > 10000)\n                        text = text.substring(text.length / 2, text.length - 1);\n                    outputBuffer.innerHTML = text + value;\n                    outputBuffer.scrollTop = outputBuffer.scrollHeight;\n                };\n                ControlsUI.prototype.OutputChar = function (char) {\n                    this.OutputString(char == null ? \" \" : char.name);\n                };\n                ControlsUI.prototype.DrawPattern = function (pattern) {\n                    function make(className) {\n                        var el = document.createElement(\"span\");\n                        el.classList.add(\"element\");\n                        el.classList.add(className);\n                        return el;\n                    }\n                    patternEl.appendChild(make(\"charSpace\"));\n                    for (var i = 0; i < pattern.length; ++i) {\n                        var el = void 0;\n                        if (pattern[i] === \".\")\n                            el = make(\"dit\");\n                        else if (pattern[i] === \"-\")\n                            el = make(\"dah\");\n                        else if (pattern[i] === \" \")\n                            el = make(\"wordSpace\");\n                        patternEl.appendChild(el);\n                    }\n                };\n                ControlsUI.prototype.Initialize = function () {\n                    var _this = this;\n                    pasteTextBoxInput.addEventListener(\"input\", this.pasteTextBoxChanged);\n                    pauseBtn.addEventListener(\"click\", this.PausePlaying);\n                    stopBtn.addEventListener(\"click\", this.StopPlaying);\n                    gearBtn.addEventListener(\"click\", function () { return location.hash = \"settings\"; });\n                    for (var i = 0; i < startBtns.length; ++i) {\n                        startBtns[i].addEventListener(\"click\", this.StartPlaying);\n                    }\n                    for (var i = 0; i < storyLinks.length; ++i) {\n                        var storyLink = storyLinks[i];\n                        storyLink.addEventListener(\"click\", function (evt) { return __awaiter(_this, void 0, void 0, function () {\n                            var anchor, href, value;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        evt.preventDefault();\n                                        anchor = evt.target;\n                                        href = anchor.href;\n                                        this.StopPlaying();\n                                        return [4, loadBook(href)];\n                                    case 1:\n                                        value = _a.sent();\n                                        pasteTextBoxInput.value = value;\n                                        this.pasteTextBoxChanged();\n                                        this.StartPlaying();\n                                        return [2];\n                                }\n                            });\n                        }); });\n                    }\n                };\n                return ControlsUI;\n            }());\n            exports_11(\"ui\", ui = new ControlsUI());\n            exports_11(\"pasteBuffer\", pasteBuffer = new pasteBuffer_1.PasteBuffer());\n        }\n    };\n});\nSystem.register(\"routing\", [\"query\"], function (exports_12, context_12) {\n    \"use strict\";\n    var query_4, routes;\n    var __moduleName = context_12 && context_12.id;\n    function setView(viewSelector, menuItemSelector) {\n        query_4.QueryAll(\".view\")\n            .filter(function (view) { return !view.classList.contains(\"disabled\"); })\n            .forEach(function (view) { return view.classList.add(\"disabled\"); });\n        query_4.Query(viewSelector).classList.remove(\"disabled\");\n        query_4.QueryAll(\".menu .btn.active\")\n            .forEach(function (button) { return button.classList.remove(\"active\"); });\n        query_4.Query(menuItemSelector).classList.add(\"active\");\n    }\n    function processHash() {\n        var route = routes[location.hash];\n        if (route)\n            setView(route.viewSelector, route.menuItemSelector);\n        if (location.hash === \"\" && location.href.indexOf(\"#\") > -1)\n            history.replaceState(\"\", document.title, window.location.pathname);\n    }\n    function Initialize() {\n        document.addEventListener(\"DOMContentLoaded\", processHash);\n        window.addEventListener(\"hashchange\", processHash);\n    }\n    exports_12(\"Initialize\", Initialize);\n    return {\n        setters: [\n            function (query_4_1) {\n                query_4 = query_4_1;\n            }\n        ],\n        execute: function () {\n            routes = {\n                \"\": { viewSelector: \".home\", menuItemSelector: \".btn-home\" },\n                \"#playing\": { viewSelector: \".playing\", menuItemSelector: \".btn-playing\" },\n                \"#settings\": { viewSelector: \".settings\", menuItemSelector: \".btn-settings\" },\n                \"#stories\": { viewSelector: \".stories\", menuItemSelector: \".btn-stories\" },\n                \"#text\": { viewSelector: \".paste\", menuItemSelector: \".btn-paste\" },\n            };\n        }\n    };\n});\nSystem.register(\"main\", [\"fullscreen\", \"routing\", \"settings\", \"controls\"], function (exports_13, context_13) {\n    \"use strict\";\n    var FullScreen, Routing, Settings, controls_3;\n    var __moduleName = context_13 && context_13.id;\n    function main() {\n        FullScreen.Initialize();\n        controls_3.ui.Initialize();\n        Settings.Initialize();\n        Routing.Initialize();\n    }\n    exports_13(\"main\", main);\n    return {\n        setters: [\n            function (FullScreen_2) {\n                FullScreen = FullScreen_2;\n            },\n            function (Routing_1) {\n                Routing = Routing_1;\n            },\n            function (Settings_1) {\n                Settings = Settings_1;\n            },\n            function (controls_3_1) {\n                controls_3 = controls_3_1;\n            }\n        ],\n        execute: function () {\n        }\n    };\n});\n\n//# sourceMappingURL=app.js.map\n"]}